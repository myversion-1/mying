<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Comparison Chart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #0c1014;
            color: #fff;
        }
        h1 {
            text-align: center;
            color: #00eaff;
            margin-bottom: 40px;
        }
        .chart-container {
            background: #1a1f24;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .metric-card {
            background: #1a1f24;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #00eaff;
        }
        .metric-name {
            font-weight: 600;
            color: #7df6ff;
            margin-bottom: 10px;
        }
        .metric-values {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }
        .value {
            flex: 1;
        }
        .improvement {
            color: #00ff88;
            font-weight: 600;
        }
        .regression {
            color: #ff4444;
            font-weight: 600;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        th {
            background: rgba(0, 234, 255, 0.1);
            color: #00eaff;
            font-weight: 600;
        }
        .positive { color: #00ff88; }
        .negative { color: #ff4444; }
    </style>
</head>
<body>
    <h1>ðŸš€ Performance Optimization Comparison</h1>
    
    <div id="charts"></div>
    <div id="metrics"></div>
    <div id="table"></div>

    <script>
        // Load comparison data
        async function loadComparison() {
            try {
                const response = await fetch('./lighthouse-reports/comparison.json');
                const data = await response.json();
                renderCharts(data);
                renderMetrics(data);
                renderTable(data);
            } catch (error) {
                document.body.innerHTML = `
                    <h1>Error Loading Data</h1>
                    <p>Please run the lighthouse test first:</p>
                    <pre>npm run lighthouse:test</pre>
                    <p>Or manually load comparison.json</p>
                `;
            }
        }

        function renderCharts(data) {
            const chartsContainer = document.getElementById('charts');
            
            // LCP Chart
            const lcpCtx = document.createElement('canvas');
            lcpCtx.id = 'lcpChart';
            const lcpContainer = document.createElement('div');
            lcpContainer.className = 'chart-container';
            lcpContainer.innerHTML = '<h3>LCP (Largest Contentful Paint) - Target: < 2.5s</h3>';
            lcpContainer.appendChild(lcpCtx);
            chartsContainer.appendChild(lcpContainer);

            new Chart(lcpCtx, {
                type: 'bar',
                data: {
                    labels: ['Before', 'After'],
                    datasets: [{
                        label: 'LCP (ms)',
                        data: [data.before.lcp, data.after.lcp],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.6)',
                            'rgba(0, 234, 255, 0.6)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(0, 234, 255, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#fff' } }
                    }
                }
            });

            // Performance Score Chart
            const scoreCtx = document.createElement('canvas');
            scoreCtx.id = 'scoreChart';
            const scoreContainer = document.createElement('div');
            scoreContainer.className = 'chart-container';
            scoreContainer.innerHTML = '<h3>Performance Score (0-100)</h3>';
            scoreContainer.appendChild(scoreCtx);
            chartsContainer.appendChild(scoreContainer);

            new Chart(scoreCtx, {
                type: 'bar',
                data: {
                    labels: ['Before', 'After'],
                    datasets: [{
                        label: 'Score',
                        data: [data.before.performanceScore, data.after.performanceScore],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.6)',
                            'rgba(0, 234, 255, 0.6)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(0, 234, 255, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#fff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    },
                    plugins: {
                        legend: { labels: { color: '#fff' } }
                    }
                }
            });
        }

        function renderMetrics(data) {
            const metricsContainer = document.getElementById('metrics');
            const metrics = ['lcp', 'fcp', 'cls', 'tti', 'speedIndex', 'totalBlockingTime', 'performanceScore'];
            
            metrics.forEach(metric => {
                const card = document.createElement('div');
                card.className = 'metric-card';
                
                const before = data.before[metric];
                const after = data.after[metric];
                const improvement = data.improvements[metric];
                
                const isPositive = metric === 'performanceScore' 
                    ? improvement > 0 
                    : improvement > 0; // For time metrics, negative improvement is good
                
                card.innerHTML = `
                    <div class="metric-name">${metric.toUpperCase()}</div>
                    <div class="metric-values">
                        <div class="value">Before: ${before.toFixed(2)}</div>
                        <div class="value">After: ${after.toFixed(2)}</div>
                        <div class="value ${isPositive ? 'improvement' : 'regression'}">
                            ${isPositive ? '+' : ''}${improvement.toFixed(2)}%
                        </div>
                    </div>
                `;
                
                metricsContainer.appendChild(card);
            });
        }

        function renderTable(data) {
            const tableContainer = document.getElementById('table');
            const table = document.createElement('table');
            
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Before</th>
                        <th>After</th>
                        <th>Improvement</th>
                    </tr>
                </thead>
                <tbody>
                    ${Object.keys(data.before).map(metric => {
                        const before = data.before[metric];
                        const after = data.after[metric];
                        const improvement = data.improvements[metric];
                        const isPositive = improvement > 0;
                        
                        return `
                            <tr>
                                <td><strong>${metric.toUpperCase()}</strong></td>
                                <td>${before.toFixed(2)}</td>
                                <td>${after.toFixed(2)}</td>
                                <td class="${isPositive ? 'positive' : 'negative'}">
                                    ${isPositive ? '+' : ''}${improvement.toFixed(2)}%
                                </td>
                            </tr>
                        `;
                    }).join('')}
                </tbody>
            `;
            
            tableContainer.appendChild(table);
        }

        // Load data on page load
        loadComparison();
    </script>
</body>
</html>



























